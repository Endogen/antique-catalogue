"use strict";exports.id=382,exports.ids=[382],exports.modules={8244:(e,t,s)=>{s.d(t,{U:()=>D});var l=s(326),a=s(7577),r=s(4064),i=s(1468),n=s(5480),d=s(3810),o=s(8091),c=s(6557);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,c.Z)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),x=(0,c.Z)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var u=s(3855),h=s(4019),p=s(4723),f=s(770),b=s(772),y=s(6115);let g=(e,t,s,l,a,r)=>{let i=Math.max(0,Math.min(r,Math.min(l,a)/2));e.beginPath(),e.moveTo(t+i,s),e.lineTo(t+l-i,s),e.quadraticCurveTo(t+l,s,t+l,s+i),e.lineTo(t+l,s+a-i),e.quadraticCurveTo(t+l,s+a,t+l-i,s+a),e.lineTo(t+i,s+a),e.quadraticCurveTo(t,s+a,t,s+a-i),e.lineTo(t,s+i),e.quadraticCurveTo(t,s,t+i,s),e.closePath()},v=(e,t)=>{if(!e.dataTransfer)return;let s=e.currentTarget;if(!(s instanceof HTMLElement))return;let l=s.getBoundingClientRect();if(!l.width||!l.height)return;let a=window.getComputedStyle(s),r=Number.parseFloat(a.borderRadius||"0"),i=Number.isNaN(r)?0:r,n=t?.radius??i,d=Number.parseFloat(a.borderWidth||"0"),o=Number.isNaN(d)?0:d,c=window.devicePixelRatio||1,m=document.createElement("canvas");m.width=Math.ceil(l.width*c),m.height=Math.ceil(l.height*c);let x=m.getContext("2d");if(!x)return;x.scale(c,c),g(x,0,0,l.width,l.height,n),x.fillStyle=a.backgroundColor||"transparent",x.fill(),o>0&&"none"!==a.borderStyle&&(x.strokeStyle=a.borderColor||"transparent",x.lineWidth=o,x.stroke());let u=Math.max(1,Math.min(2.5,.06*l.width)),h=l.width/2,p=.12*l.width,f=.28*l.height,b=.72*l.height;x.beginPath(),x.strokeStyle=a.color||"#000",x.lineWidth=u,x.lineCap="round",x.moveTo(h-p,f),x.lineTo(h-p,b),x.moveTo(h+p,f),x.lineTo(h+p,b),x.stroke(),e.dataTransfer.setDragImage(m,l.width/2,l.height/2)};var j=s(7863),N=s(6824);let w=e=>f.Ry({name:f.Z_().min(1,e("Field name is required")).max(120,e("Keep the name under 120 characters")),field_type:f.Km(["text","number","date","timestamp","checkbox","select"]),is_required:f.O7(),is_private:f.O7()}),k=e=>[{value:"text",label:e("Text"),helper:e("Free-form text")},{value:"number",label:e("Number"),helper:e("Integers or decimals")},{value:"date",label:e("Date"),helper:e("YYYY-MM-DD format")},{value:"timestamp",label:e("Timestamp"),helper:e("Date + time")},{value:"checkbox",label:e("Checkbox"),helper:e("True or false")},{value:"select",label:e("Select"),helper:e("Choose from options")}],S={name:"",field_type:"text",is_required:!1,is_private:!1},M=e=>{let t=new Map;return e.forEach(e=>{let s=e.trim();if(!s)return;let l=s.toLowerCase();t.has(l)||t.set(l,s)}),Array.from(t.values())},C=e=>e?.options&&Array.isArray(e.options)?M(e.options.filter(e=>"string"==typeof e)):[],_=(e,t)=>e.find(e=>e.value===t)??e[0],T=e=>[...e].sort((e,t)=>e.position-t.position||e.id-t.id),Z=(e,t,s)=>{let l=[...e],[a]=l.splice(t,1);return l.splice(s,0,a),l};function D({collectionId:e,api:t}){let{t:s}=(0,y.Q)(),[c,f]=a.useState("loading"),[g,D]=a.useState([]),[q,A]=a.useState(null),[z,F]=a.useState(null),[P,E]=a.useState(null),[R,K]=a.useState(null),[L,W]=a.useState(""),[I,O]=a.useState([]),[H,U]=a.useState(null),[V,Y]=a.useState(null),[B,G]=a.useState(null),[Q,J]=a.useState(null),[X,$]=a.useState(!1),[ee,et]=a.useState(null),es=a.useMemo(()=>w(s),[s]),el=a.useMemo(()=>k(s),[s]),ea=a.useCallback(e=>_(el,e),[el]),{register:er,handleSubmit:ei,formState:{errors:en,isSubmitting:ed},reset:eo,watch:ec}=(0,p.cI)({resolver:(0,r.F)(es),defaultValues:S}),em=ec("field_type"),ex=a.useMemo(()=>t||(e?{list:()=>N.cK.list(e),create:t=>N.cK.create(e,t),update:(t,s)=>N.cK.update(e,t,s),delete:t=>N.cK.delete(e,t),reorder:t=>N.cK.reorder(e,t)}:null),[t,e]),eu=a.useMemo(()=>g.find(e=>e.id===H)??null,[g,H]),eh=a.useCallback(async()=>{if(!ex){f("error"),A("Schema source is missing.");return}f("loading"),A(null);try{let e=await ex.list();D(T(e)),f("ready")}catch(e){f("error"),A((0,N.k0)(e)?e.detail:"We couldn't load schema fields.")}},[ex]);a.useEffect(()=>{eh()},[eh]),a.useEffect(()=>{E(null),eu?(eo({name:eu.name,field_type:eu.field_type,is_required:eu.is_required,is_private:eu.is_private}),O(C(eu.options))):(eo(S),O([])),W(""),K(null),F(null)},[eu,eo]);let ep=a.useCallback(()=>{let e=L.split(",").map(e=>e.trim()).filter(Boolean);if(0===e.length){K("Enter at least one option.");return}O(t=>M([...t,...e])),W(""),K(null)},[L]),ef=async e=>{if(!ex){F("Schema source is missing.");return}F(null),E(null),K(null);let t=e.name.trim(),s=M(I);if("select"===e.field_type&&0===s.length){K("Add at least one option for select fields.");return}let l={name:t,field_type:e.field_type,is_required:e.is_required,is_private:e.is_private,options:"select"===e.field_type?{options:s}:null};try{if(H){let e=await ex.update(H,l);D(t=>T(t.map(t=>t.id===e.id?e:t))),E("Field updated.")}else{let e=await ex.create(l);D(t=>T([...t,e])),E("Field added."),eo(S),O([]),W("")}}catch(e){F((0,N.k0)(e)?e.detail:"We couldn't save the field. Please try again.")}},eb=async e=>{if(!ex){F("Schema source is missing.");return}let t=g.find(t=>t.id===e);if(t&&window.confirm(s('Delete the "{name}" field? This cannot be undone.',{name:t.name}))){et(e),F(null),E(null);try{await ex.delete(e),D(t=>t.filter(t=>t.id!==e)),H===e&&U(null),E("Field deleted.")}catch(e){F((0,N.k0)(e)?e.detail:"We couldn't delete the field. Please try again.")}finally{et(null)}}},ey=async e=>{if(!ex)throw J("Schema source is missing."),Error("Schema source is missing.");$(!0),J(null),E(null);try{let t=await ex.reorder(e.map(e=>e.id));D(T(t)),E("Field order updated.")}catch(e){throw J((0,N.k0)(e)?e.detail:"We couldn't reorder fields. Please try again."),e}finally{$(!1)}},eg=async(e,t)=>{if(X||t<0||t>=g.length)return;let s=Z(g,e,t);D(s);try{await ey(s)}catch{D(g)}},ev=(e,t)=>{e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",String(t)),v(e),Y(t)},ej=(e,t)=>{e.preventDefault(),B!==t&&G(t)},eN=async(e,t)=>{e.preventDefault();let s=V??Number(e.dataTransfer.getData("text/plain"));if(!s||s===t){Y(null),G(null);return}let l=g.findIndex(e=>e.id===s),a=g.findIndex(e=>e.id===t);if(-1===l||-1===a){Y(null),G(null);return}await eg(l,a),Y(null),G(null)},ew=()=>{Y(null),G(null)};return(0,l.jsxs)("div",{className:"rounded-3xl border border-stone-200 bg-white/90 p-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:s("Schema builder")}),l.jsx("h2",{className:"font-display mt-3 text-2xl text-stone-900",children:s("Define the metadata you need.")}),l.jsx("p",{className:"mt-3 max-w-2xl text-sm text-stone-600",children:s("Add, edit, and reorder fields to match how you catalog each item. Drag fields to reorder and mark required attributes.")})]}),(0,l.jsxs)(b.z,{variant:"outline",onClick:()=>eh(),children:[l.jsx(i.Z,{className:"h-4 w-4"}),s("Refresh")]})]}),"loading"===c?l.jsx("div",{className:"mt-6 rounded-2xl border border-dashed border-stone-200 bg-white/80 p-6 text-sm text-stone-500","aria-busy":"true",children:s("Loading schema fields...")}):"error"===c?(0,l.jsxs)("div",{className:"mt-6 rounded-2xl border border-rose-200 bg-rose-50/80 p-6",children:[l.jsx("p",{className:"text-sm font-medium text-rose-700",children:s("We hit a snag loading your schema.")}),l.jsx("p",{className:"mt-2 text-sm text-rose-600",children:s(q??"Please try again.")}),l.jsx("div",{className:"mt-4",children:l.jsx(b.z,{variant:"outline",onClick:()=>eh(),children:s("Try again")})})]}):(0,l.jsxs)("div",{className:"mt-6 grid gap-6 lg:grid-cols-[2fr_1fr]",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[l.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:s("Fields")}),l.jsx("span",{className:"text-xs text-stone-400",children:s("{count} total",{count:g.length})})]}),Q?l.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50/80 px-4 py-3 text-xs text-rose-700",children:s(Q)}):null,0===g.length?l.jsx("div",{className:"rounded-2xl border border-dashed border-stone-200 bg-white/80 p-6 text-sm text-stone-500",children:s("No fields yet. Add your first field to define the schema.")}):l.jsx("div",{className:"space-y-3",children:g.map((e,t)=>{let a=ea(e.field_type),r=C(e.options).join(", "),i=e.id===H;return(0,l.jsxs)("div",{className:(0,j.cn)("rounded-2xl border bg-white/80 p-4 shadow-sm transition",B===e.id?"border-amber-300 bg-amber-50/70":"border-stone-200"),onDragOver:t=>ej(t,e.id),onDrop:t=>eN(t,e.id),children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[l.jsx("button",{type:"button",className:(0,j.cn)("flex h-10 w-10 items-center justify-center rounded-xl border text-stone-500 transition",V===e.id?"border-amber-300 bg-amber-50 text-amber-700":"border-stone-200 bg-stone-50 hover:border-stone-300"),draggable:!X,"aria-label":s("Drag to reorder {name}",{name:e.name}),onDragStart:t=>ev(t,e.id),onDragEnd:ew,children:l.jsx(n.Z,{className:"h-4 w-4"})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[l.jsx("p",{className:"text-sm font-medium text-stone-900",children:e.name}),e.is_required?l.jsx("span",{className:"rounded-full border border-amber-200 bg-amber-50 px-2 py-0.5 text-[10px] font-medium uppercase tracking-[0.2em] text-amber-700",children:s("Required")}):null,e.is_private?l.jsx("span",{className:"rounded-full border border-stone-200 bg-stone-100 px-2 py-0.5 text-[10px] font-medium uppercase tracking-[0.2em] text-stone-600",children:s("Private")}):null]}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-stone-500",children:[a.label," \xb7 ",a.helper]}),"select"===e.field_type&&r?l.jsx("p",{className:"mt-2 text-xs text-stone-500",children:s("Options: {options}",{options:r})}):null]})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,l.jsxs)(b.z,{size:"sm",variant:i?"secondary":"ghost",onClick:()=>U(e.id),children:[l.jsx(d.Z,{className:"h-4 w-4"}),i?s("Editing"):s("Edit")]}),(0,l.jsxs)(b.z,{size:"sm",variant:"ghost",onClick:()=>eb(e.id),disabled:ee===e.id,children:[l.jsx(o.Z,{className:"h-4 w-4"}),ee===e.id?s("Deleting..."):s("Delete")]})]})]}),(0,l.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-xs text-stone-500",children:[l.jsx("span",{className:"rounded-full border border-stone-200 bg-stone-50 px-3 py-1",children:s("Position {position}",{position:t+1})}),(0,l.jsxs)(b.z,{size:"sm",variant:"ghost",onClick:()=>eg(t,t-1),disabled:0===t||X,children:[l.jsx(m,{className:"h-4 w-4"}),s("Move up")]}),(0,l.jsxs)(b.z,{size:"sm",variant:"ghost",onClick:()=>eg(t,t+1),disabled:t===g.length-1||X,children:[l.jsx(x,{className:"h-4 w-4"}),s("Move down")]}),X?l.jsx("span",{className:"text-xs text-amber-700",children:s("Saving order...")}):null]})]},e.id)})})]}),(0,l.jsxs)("div",{className:"rounded-2xl border border-stone-200 bg-white/80 p-4",children:[l.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:eu?s("Edit field"):s("New field")}),l.jsx("h3",{className:"mt-3 text-lg font-semibold text-stone-900",children:eu?s("Adjust the field details."):s("Add a new field.")}),l.jsx("p",{className:"mt-2 text-xs text-stone-500",children:s("Changes apply to new items immediately.")}),P?l.jsx("div",{className:"mt-4 rounded-2xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-700",children:s(P)}):null,z?l.jsx("div",{className:"mt-4 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:s(z)}):null,(0,l.jsxs)("form",{className:"mt-4 space-y-4",onSubmit:ei(ef),children:[(0,l.jsxs)("div",{children:[l.jsx("label",{className:"text-xs font-medium text-stone-700",htmlFor:"field-name",children:s("Field name")}),l.jsx("input",{id:"field-name",type:"text",autoComplete:"off",className:"mt-2 w-full rounded-xl border border-stone-200 bg-white px-3 py-2 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200","aria-invalid":en.name?"true":"false",...er("name")}),en.name?l.jsx("p",{className:"mt-2 text-xs text-rose-600",children:en.name.message}):null]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"text-xs font-medium text-stone-700",htmlFor:"field-type",children:s("Field type")}),l.jsx("select",{id:"field-type",className:"mt-2 w-full rounded-xl border border-stone-200 bg-white px-3 py-2 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200",...er("field_type"),children:el.map(e=>l.jsx("option",{value:e.value,children:e.label},e.value))}),l.jsx("p",{className:"mt-2 text-xs text-stone-500",children:ea(em).helper})]}),(0,l.jsxs)("label",{className:"flex items-center gap-3 rounded-xl border border-stone-200 bg-stone-50/80 px-3 py-2 text-xs text-stone-600",title:s("This field must be set to save an item."),children:[l.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-amber-600",...er("is_required")}),s("Required field"),l.jsx("span",{className:"text-stone-400",children:"?"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-3 rounded-xl border border-stone-200 bg-stone-50/80 px-3 py-2 text-xs text-stone-600",title:s("Hidden from public collections"),children:[l.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-amber-600",...er("is_private")}),s("Private field"),l.jsx("span",{className:"text-stone-400",children:"?"})]}),"select"===em?(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{children:[l.jsx("label",{className:"text-xs font-medium text-stone-700",htmlFor:"field-options",children:s("Options")}),(0,l.jsxs)("div",{className:"mt-2 flex gap-2",children:[l.jsx("input",{id:"field-options",type:"text",value:L,onChange:e=>W(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),ep())},placeholder:s("Add option values"),className:"flex-1 rounded-xl border border-stone-200 bg-white px-3 py-2 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200"}),(0,l.jsxs)(b.z,{type:"button",variant:"outline",onClick:ep,children:[l.jsx(u.Z,{className:"h-4 w-4"}),s("Add")]})]}),R?l.jsx("p",{className:"mt-2 text-xs text-rose-600",children:s(R)}):l.jsx("p",{className:"mt-2 text-xs text-stone-500",children:s("Separate options with commas or hit enter after each value.")})]}),I.length>0?l.jsx("div",{className:"flex flex-wrap gap-2",children:I.map(e=>(0,l.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-full border border-stone-200 bg-white px-3 py-1 text-xs text-stone-600",children:[e,l.jsx("button",{type:"button",className:"text-stone-400 transition hover:text-stone-600",onClick:()=>O(t=>t.filter(t=>t!==e)),"aria-label":s("Remove {option}",{option:e}),children:l.jsx(h.Z,{className:"h-3.5 w-3.5"})})]},e))}):null]}):null,(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[eu?(0,l.jsxs)(b.z,{type:"button",variant:"ghost",onClick:()=>{U(null),E(null),F(null),K(null)},children:[l.jsx(h.Z,{className:"h-4 w-4"}),s("Cancel")]}):null,l.jsx(b.z,{type:"submit",disabled:ed,children:ed?eu?s("Updating..."):s("Adding..."):eu?s("Update field"):s("Add field")})]})]})]})]})]})}},6333:(e,t,s)=>{s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(6557).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5480:(e,t,s)=>{s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(6557).Z)("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]])},3810:(e,t,s)=>{s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(6557).Z)("PencilLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}],["path",{d:"m15 5 3 3",key:"1w25hb"}]])},3855:(e,t,s)=>{s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(6557).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1468:(e,t,s)=>{s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(6557).Z)("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]])},8091:(e,t,s)=>{s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(6557).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}};