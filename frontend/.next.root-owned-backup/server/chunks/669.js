"use strict";exports.id=669,exports.ids=[669],exports.modules={4127:(e,t,s)=>{s.d(t,{W:()=>N});var r=s(326),a=s(7577),i=s(4064),n=s(4723),l=s(770),d=s(772),o=s(6115);let m=e=>l.Ry({name:l.Z_().min(1,e("Item name is required")).max(160,e("Keep the name under 160 characters")),notes:l.Z_().max(2e3,e("Keep the notes under 2000 characters")).optional().or(l.i0("")),metadata:l.IM(l._4()).optional(),is_highlight:l.O7().optional()}),u=e=>({text:e("Text"),number:e("Number"),date:e("Date"),timestamp:e("Timestamp"),checkbox:e("Checkbox"),select:e("Select")}),c=e=>[...e].sort((e,t)=>e.position-t.position||e.id-t.id),p=e=>{let t=new Map;return e.forEach(e=>{let s=e.trim();if(!s)return;let r=s.toLowerCase();t.has(r)||t.set(r,s)}),Array.from(t.values())},h=e=>e?.options&&Array.isArray(e.options)?p(e.options.filter(e=>"string"==typeof e)):[],f=e=>null==e||"string"==typeof e&&""===e.trim(),x=e=>{let t=e.trim();if(!t)return"";let s=t.match(/^(\d{4}-\d{2}-\d{2})/);return s?s[1]:t},b=e=>{let t=e.trim();if(!t)return"";let s=t.replace(" ","T"),r=s.match(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2})/);return r?r[1]:s},g=(e,t)=>{let s={};return e.forEach(e=>{let r=String(e.id),a=t?t[e.name]:void 0;if(null==a){s[r]="checkbox"!==e.field_type&&"";return}if("number"===e.field_type){if("number"==typeof a&&!Number.isNaN(a)){s[r]=a;return}if("string"==typeof a){let e=Number(a);s[r]=Number.isNaN(e)?"":e;return}s[r]="";return}if("checkbox"===e.field_type){if("boolean"==typeof a){s[r]=a;return}if("string"==typeof a){s[r]="true"===a.toLowerCase();return}s[r]=!1;return}if("date"===e.field_type&&"string"==typeof a){s[r]=x(a);return}if("timestamp"===e.field_type&&"string"==typeof a){s[r]=b(a);return}if("string"==typeof a){s[r]=a;return}s[r]=String(a)}),s},y=(e,t,s)=>{let r=[],a={},i=t??{};return(e.forEach(e=>{let t=String(e.id),n=i[t];if(f(n)){e.is_required&&r.push({fieldId:t,message:s("Field is required")});return}if("text"===e.field_type){if("string"!=typeof n){r.push({fieldId:t,message:s("Value must be a string")});return}let i=n.trim();if(e.is_required&&!i){r.push({fieldId:t,message:s("Field is required")});return}i&&(a[e.name]=i);return}if("number"===e.field_type){let i="number"==typeof n?n:"string"==typeof n?Number(n):NaN;if(Number.isNaN(i)){r.push({fieldId:t,message:s("Value must be a number")});return}a[e.name]=i;return}if("date"===e.field_type){if("string"!=typeof n){r.push({fieldId:t,message:s("Value must be a date (YYYY-MM-DD)")});return}let i=n.trim();if(!/^\d{4}-\d{2}-\d{2}$/.test(i)||Number.isNaN(new Date(`${i}T00:00:00Z`).getTime())){r.push({fieldId:t,message:s("Value must be a date (YYYY-MM-DD)")});return}a[e.name]=i;return}if("timestamp"===e.field_type){if("string"!=typeof n){r.push({fieldId:t,message:s("Value must be a timestamp (ISO 8601)")});return}let i=n.trim();if(!i||!i.includes("T")&&!i.includes(" ")||Number.isNaN(new Date(i.endsWith("Z")?`${i.slice(0,-1)}+00:00`:i).getTime())){r.push({fieldId:t,message:s("Value must be a timestamp (ISO 8601)")});return}a[e.name]=i;return}if("checkbox"===e.field_type){if("boolean"!=typeof n){r.push({fieldId:t,message:s("Value must be true or false")});return}a[e.name]=n;return}if("select"===e.field_type){if("string"!=typeof n){r.push({fieldId:t,message:s("Value must be a string")});return}let i=n.trim(),l=h(e.options);if(!l.length){r.push({fieldId:t,message:s("Select field is missing options")});return}if(!i||!l.includes(i)){r.push({fieldId:t,message:s("Value must be one of: {options}",{options:l.join(", ")})});return}a[e.name]=i;return}r.push({fieldId:t,message:s("Unsupported field type")})}),Object.keys(a).length)?{payload:a,errors:r}:{payload:null,errors:r}};function N({fields:e,initialValues:t,onSubmit:s,submitLabel:l,submitPendingLabel:p,secondaryAction:f,formError:x,render:b}){let{t:N}=(0,o.Q)(),j=a.useMemo(()=>u(N),[N]),_=a.useMemo(()=>m(N),[N]),v=a.useMemo(()=>c(e),[e]),w=a.useMemo(()=>({name:t?.name??"",notes:t?.notes??"",metadata:g(v,t?.metadata),is_highlight:t?.is_highlight??!1}),[t?.is_highlight,t?.metadata,t?.name,t?.notes,v]),{register:M,handleSubmit:k,formState:{errors:I,isSubmitting:Y},reset:$,setError:S,clearErrors:D}=(0,n.cI)({resolver:(0,i.F)(_),defaultValues:w});a.useEffect(()=>{$(w)},[w,$]);let V=a.useCallback((e,t)=>{let s=M(`metadata.${e}`,t);return{...s,onChange:t=>{s.onChange(t),D(`metadata.${e}`)}}},[D,M]),q=async e=>{D("metadata");let t=e.name.trim(),r=e.notes?.trim()?e.notes.trim():null,{payload:a,errors:i}=y(v,e.metadata,N);if(i.length){i.forEach(e=>{S(`metadata.${e.fieldId}`,{type:"manual",message:e.message})});return}await s({name:t,notes:r,metadata:a,is_highlight:!!e.is_highlight})},C=I.metadata,Z=x?r.jsx("div",{role:"alert",className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:N(x)}):null,F=(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-sm font-medium text-stone-700",htmlFor:"name",children:N("Item name")}),r.jsx("input",{id:"name",type:"text",autoComplete:"off",className:"mt-2 w-full rounded-xl border border-stone-200 bg-white px-4 py-3 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200","aria-invalid":I.name?"true":"false",...M("name")}),I.name?r.jsx("p",{className:"mt-2 text-xs text-rose-600",children:I.name.message}):null]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-sm font-medium text-stone-700",htmlFor:"notes",children:N("Notes")}),r.jsx("textarea",{id:"notes",rows:4,className:"mt-2 w-full rounded-xl border border-stone-200 bg-white px-4 py-3 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200",...M("notes")}),I.notes?r.jsx("p",{className:"mt-2 text-xs text-rose-600",children:I.notes.message}):r.jsx("p",{className:"mt-2 text-xs text-stone-500",children:N("Optional context, provenance, or acquisition details.")})]}),r.jsx("div",{className:"rounded-2xl border border-amber-200/70 bg-amber-50/40 p-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-sm font-medium text-stone-800",htmlFor:"is_highlight",children:N("Spotlight item")}),r.jsx("p",{className:"mt-1 text-xs text-stone-600",children:N("Adds a warm glow to featured items across the catalogue.")})]}),r.jsx("input",{id:"is_highlight",type:"checkbox",className:"mt-1 h-5 w-5 rounded border-amber-300 text-amber-600 focus:ring-amber-200",...M("is_highlight")})]})})]}),T=(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:N("Metadata")}),r.jsx("h3",{className:"font-display mt-3 text-2xl text-stone-900",children:N("Capture collection-specific fields.")}),r.jsx("p",{className:"mt-2 text-sm text-stone-600",children:N("Complete the schema-driven attributes for this item.")})]}),0===v.length?r.jsx("div",{className:"rounded-2xl border border-dashed border-stone-200 bg-white/70 p-6 text-sm text-stone-500",children:N("No schema fields yet. Define fields in collection settings to capture metadata.")}):r.jsx("div",{className:"grid gap-4",children:v.map(e=>{let t=String(e.id),s=C?.[t]?.message,a="select"===e.field_type?h(e.options):[];return"checkbox"===e.field_type?(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4 rounded-2xl border border-stone-200 bg-white/80 p-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-sm font-medium text-stone-700",htmlFor:`metadata-${e.id}`,children:e.name}),(0,r.jsxs)("p",{className:"mt-1 text-xs text-stone-500",children:[j[e.field_type]??e.field_type,e.is_required?` \xb7 ${N("Required")}`:` \xb7 ${N("Optional")}`]}),s?r.jsx("p",{className:"mt-2 text-xs text-rose-600",children:s}):null]}),r.jsx("input",{id:`metadata-${e.id}`,type:"checkbox",className:"mt-1 h-5 w-5 rounded border-stone-300 text-amber-600 focus:ring-amber-200","aria-invalid":s?"true":"false",...V(t)})]},e.id):(0,r.jsxs)("div",{className:"flex flex-col gap-2 rounded-2xl border border-stone-200 bg-white/80 p-4",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.jsx("label",{className:"text-sm font-medium text-stone-700",htmlFor:`metadata-${e.id}`,children:e.name}),(0,r.jsxs)("span",{className:"text-xs uppercase tracking-[0.2em] text-stone-400",children:[j[e.field_type]??e.field_type,e.is_required?` \xb7 ${N("Required")}`:` \xb7 ${N("Optional")}`]})]}),"select"===e.field_type?(0,r.jsxs)("select",{id:`metadata-${e.id}`,className:"h-10 rounded-xl border border-stone-200 bg-white px-3 text-sm text-stone-700 shadow-sm focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200","aria-invalid":s?"true":"false",...V(t),disabled:!a.length,children:[r.jsx("option",{value:"",children:N("Select a value")}),a.map(e=>r.jsx("option",{value:e,children:e},e))]}):r.jsx("input",{id:`metadata-${e.id}`,type:"number"===e.field_type?"number":"date"===e.field_type?"date":"timestamp"===e.field_type?"datetime-local":"text",step:"number"===e.field_type?"any":void 0,className:"h-10 rounded-xl border border-stone-200 bg-white px-3 text-sm text-stone-700 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200","aria-invalid":s?"true":"false",placeholder:"date"===e.field_type?N("YYYY-MM-DD"):"timestamp"===e.field_type?N("YYYY-MM-DDThh:mm"):N("Enter value"),...V(t,{setValueAs:"number"===e.field_type?e=>""===e||null===e?void 0:Number(e):void 0})}),s?r.jsx("p",{className:"text-xs text-rose-600",children:s}):null]},e.id)})})]}),E=(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[f,r.jsx(d.z,{type:"submit",disabled:Y,children:Y?p??N("Saving..."):l})]});return r.jsx("form",{className:"space-y-8",onSubmit:k(q),children:b?b({formError:Z,baseFields:F,metadataFields:T,actions:E}):(0,r.jsxs)(r.Fragment,{children:[Z,F,T,E]})})}},6333:(e,t,s)=>{s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(6557).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},210:(e,t,s)=>{s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(6557).Z)("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]])},1468:(e,t,s)=>{s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(6557).Z)("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]])}};