(()=>{var e={};e.id=915,e.ids=[915],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5347:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),s(362),s(639),s(5866),s(9157);var a=s(3191),r=s(8716),n=s(7922),l=s.n(n),o=s(5231),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);s.d(t,i);let d=["",{children:["(app)",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,362)),"/home/endogen/projects/antique-catalogue/frontend/app/(app)/profile/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,639)),"/home/endogen/projects/antique-catalogue/frontend/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,9157)),"/home/endogen/projects/antique-catalogue/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/endogen/projects/antique-catalogue/frontend/app/(app)/profile/page.tsx"],u="/(app)/profile/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(app)/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9745:(e,t,s)=>{Promise.resolve().then(s.bind(s,6007))},6007:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var a=s(326),r=s(7577),n=s(6226),l=s(434),o=s(6557);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,o.Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var d=s(5983),c=s(8705),u=s(3734),m=s(7200),x=s(5290);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,o.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),h=(0,o.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var g=s(1896),f=s(8091),y=s(209),b=s(6115),v=s(772),j=s(6824);function N(){let{t:e,locale:t}=(0,b.Q)(),{refresh:s}=(0,y.a)(),[o,N]=r.useState({status:"loading",data:null}),[w,k]=r.useState(""),[P,_]=r.useState({status:"idle"}),[q,Z]=r.useState({status:"idle"}),[M,S]=r.useState(0),C=r.useRef(null),z=r.useCallback(e=>{if(!e)return"-";let s=new Date(e);return Number.isNaN(s.getTime())?e:new Intl.DateTimeFormat(t,{month:"short",day:"numeric",year:"numeric"}).format(s)},[t]),A=r.useCallback(async()=>{N(e=>({...e,status:"loading",error:void 0}));try{let e=await j.c_.me();N({status:"ready",data:e}),k(e.username)}catch(e){N(t=>({status:"error",data:t.data,error:(0,j.k0)(e)?e.detail:"We couldn't load your profile."}))}},[]);r.useEffect(()=>{A()},[A]);let R=async e=>{e.preventDefault(),_({status:"saving"});try{let e=await j.c_.updateMe({username:w});N({status:"ready",data:e}),k(e.username),_({status:"saved",message:"Username updated."}),await s()}catch(e){_({status:"error",message:(0,j.k0)(e)?e.detail:"We couldn't update your username."})}},U=async e=>{let t=e.target.files?.[0];if(t){Z({status:"uploading"});try{let e=await j.c_.uploadAvatar(t);N({status:"ready",data:e}),S(e=>e+1),Z({status:"idle"})}catch(e){Z({status:"error",message:(0,j.k0)(e)?e.detail:"We couldn't upload your avatar."})}C.current&&(C.current.value="")}},E=async()=>{Z({status:"deleting"});try{await j.c_.deleteAvatar(),N(e=>e.data?{...e,data:{...e.data,has_avatar:!1}}:e),Z({status:"idle"})}catch(e){Z({status:"error",message:(0,j.k0)(e)?e.detail:"We couldn't remove your avatar."})}},V=o.data;return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("header",{className:"rounded-3xl border border-stone-200 bg-white/90 p-6 shadow-sm",children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-amber-700",children:e("Profile")}),a.jsx("h1",{className:"font-display mt-4 text-3xl text-stone-900",children:e("Your public profile")}),a.jsx("p",{className:"mt-3 max-w-2xl text-sm text-stone-600",children:e("Manage how your public archive identity appears to everyone.")}),V?.username?a.jsx("div",{className:"mt-5",children:a.jsx(v.z,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)(l.default,{href:`/profile/${encodeURIComponent(V.username)}`,children:[a.jsx(i,{className:"h-4 w-4"}),e("View public profile")]})})}):null]}),(0,a.jsxs)("section",{className:"rounded-3xl border border-stone-900 bg-stone-950 p-6 text-stone-100",children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-400",children:e("Profile summary")}),a.jsx("p",{className:"mt-3 text-sm text-stone-300",children:e("Member since {date}",{date:z(V?.created_at)})}),(0,a.jsxs)("div",{className:"mt-4 grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)("div",{className:"rounded-xl border border-stone-800 bg-stone-900/70 p-3",children:[(0,a.jsxs)("p",{className:"inline-flex items-center gap-2 text-xs text-stone-300",children:[a.jsx(d.Z,{className:"h-3.5 w-3.5 text-amber-300"}),e("Public collections")]}),a.jsx("p",{className:"mt-2 text-xl font-semibold text-stone-100",children:V?.public_collection_count??0})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-stone-800 bg-stone-900/70 p-3",children:[(0,a.jsxs)("p",{className:"inline-flex items-center gap-2 text-xs text-stone-300",children:[a.jsx(c.Z,{className:"h-3.5 w-3.5 text-amber-300"}),e("Public items")]}),a.jsx("p",{className:"mt-2 text-xl font-semibold text-stone-100",children:V?.public_item_count??0})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-stone-800 bg-stone-900/70 p-3",children:[(0,a.jsxs)("p",{className:"inline-flex items-center gap-2 text-xs text-stone-300",children:[a.jsx(u.Z,{className:"h-3.5 w-3.5 text-amber-300"}),e("Stars earned")]}),a.jsx("p",{className:"mt-2 text-xl font-semibold text-stone-100",children:V?.earned_star_count??0})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-stone-800 bg-stone-900/70 p-3",children:[(0,a.jsxs)("p",{className:"inline-flex items-center gap-2 text-xs text-stone-300",children:[a.jsx(m.Z,{className:"h-3.5 w-3.5 text-amber-300"}),e("Star rank")]}),(0,a.jsxs)("p",{className:"mt-2 text-xl font-semibold text-stone-100",children:["#",V?.star_rank??1]})]})]})]}),(0,a.jsxs)("section",{className:"grid gap-6 lg:grid-cols-[1.4fr_1fr]",children:[(0,a.jsxs)("div",{className:"rounded-3xl border border-stone-200 bg-white/90 p-6 shadow-sm",children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:e("Username")}),a.jsx("h2",{className:"font-display mt-3 text-2xl text-stone-900",children:e("Choose your public username")}),a.jsx("p",{className:"mt-2 text-sm text-stone-600",children:e("Use up to 12 characters with letters, numbers, underscores, or hyphens.")}),"loading"!==o.status||V?"error"!==o.status||V?(0,a.jsxs)("form",{className:"mt-6 space-y-4",onSubmit:R,children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-stone-700",htmlFor:"username",children:e("Public username")}),a.jsx("input",{id:"username",type:"text",maxLength:12,autoComplete:"off",className:"mt-2 w-full rounded-xl border border-stone-200 bg-white px-4 py-3 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200",value:w,onChange:e=>k(e.target.value)})]}),"error"===P.status&&P.message?a.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:e(P.message)}):null,"saved"===P.status&&P.message?a.jsx("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700",children:e(P.message)}):null,(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsxs)(v.z,{type:"submit",disabled:"saving"===P.status,children:["saving"===P.status?a.jsx(x.Z,{className:"h-4 w-4 animate-spin"}):a.jsx(p,{className:"h-4 w-4"}),e("saving"===P.status?"Saving...":"Save username")]}),a.jsx(v.z,{variant:"outline",type:"button",onClick:()=>A(),children:e("Refresh")})]})]}):a.jsx("p",{className:"mt-6 text-sm text-rose-600",children:e(o.error??"We couldn't load your profile.")}):a.jsx("p",{className:"mt-6 text-sm text-stone-500",children:e("Loading profile...")})]}),(0,a.jsxs)("div",{className:"rounded-3xl border border-stone-200 bg-white/90 p-6 shadow-sm",children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:e("Profile picture")}),a.jsx("h2",{className:"font-display mt-3 text-2xl text-stone-900",children:e("Set your avatar")}),a.jsx("p",{className:"mt-2 text-sm text-stone-600",children:e("Upload a photo that represents you. Max 5MB, JPEG or PNG.")}),(0,a.jsxs)("div",{className:"mt-6 flex flex-wrap items-center gap-6",children:[a.jsx("div",{className:"relative h-24 w-24 shrink-0 overflow-hidden rounded-full border-2 border-stone-200 bg-stone-100",children:V?.has_avatar?a.jsx(n.default,{src:(0,j.Qx)(V.id,"medium"),alt:V.username,width:96,height:96,className:"h-full w-full object-cover",unoptimized:!0},M):a.jsx("div",{className:"flex h-full w-full items-center justify-center",children:a.jsx(h,{className:"h-10 w-10 text-stone-300"})})}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[a.jsx("input",{ref:C,type:"file",accept:"image/jpeg,image/png,image/webp",className:"hidden",onChange:U}),(0,a.jsxs)(v.z,{variant:"outline",onClick:()=>C.current?.click(),disabled:"uploading"===q.status||"deleting"===q.status,children:["uploading"===q.status?a.jsx(x.Z,{className:"h-4 w-4 animate-spin"}):a.jsx(g.Z,{className:"h-4 w-4"}),e("uploading"===q.status?"Uploading...":"Upload photo")]}),V?.has_avatar?(0,a.jsxs)(v.z,{variant:"outline",onClick:E,disabled:"uploading"===q.status||"deleting"===q.status,className:"text-rose-600 hover:text-rose-700",children:["deleting"===q.status?a.jsx(x.Z,{className:"h-4 w-4 animate-spin"}):a.jsx(f.Z,{className:"h-4 w-4"}),e("deleting"===q.status?"Removing...":"Remove")]}):null]})]}),"error"===q.status&&q.message?a.jsx("div",{className:"mt-4 rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:e(q.message)}):null]})]})]})}},7200:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},1896:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},5290:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8705:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},8091:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(6557).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},5047:(e,t,s)=>{"use strict";var a=s(7389);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},362:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>o});var a=s(8570);let r=(0,a.createProxy)(String.raw`/home/endogen/projects/antique-catalogue/frontend/app/(app)/profile/page.tsx`),{__esModule:n,$$typeof:l}=r;r.default;let o=(0,a.createProxy)(String.raw`/home/endogen/projects/antique-catalogue/frontend/app/(app)/profile/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[716,697,449,373],()=>s(5347));module.exports=a})();