(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{9070:function(e,t,n){Promise.resolve().then(n.bind(n,6154)),Promise.resolve().then(n.bind(n,7908))},6154:function(e,t,n){"use strict";n.d(t,{AppShell:function(){return S}});var s=n(7437),r=n(2265),a=n(6648),o=n(7138),l=n(6463),i=n(1066);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,i.Z)("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);var u=n(5430),d=n(8496),h=n(3907),m=n(9338);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,i.Z)("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);var f=n(1326);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,i.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),b=(0,i.Z)("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);var g=n(4697);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let y=(0,i.Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var v=n(4817),k=n(9896),j=n(2328),w=n(1295),N=n(495),Z=n(7440);let C=e=>{let{onNavigate:t,onClose:n}=e,r=(0,l.usePathname)(),{t:i}=(0,w.Q)(),y=[{label:i("Dashboard"),href:"/dashboard",description:i("Your private archive"),icon:c,match:["/dashboard"]},{label:i("Speed Capture"),href:"/speed-capture",description:i("Quick photo-first cataloguing"),icon:u.Z,match:["/speed-capture"]},{label:i("Collections"),href:"/collections",description:i("Saved collections"),icon:d.Z,match:["/collections"]},{label:i("Schema templates"),href:"/schema-templates",description:i("Reusable metadata schemas"),icon:h.Z,match:["/schema-templates"]},{label:i("Stars"),href:"/stars",description:i("Starred items and collections"),icon:m.Z,match:["/stars"]},{label:i("Profile"),href:"/profile",description:i("Your public profile"),icon:x,match:["/profile"]},{label:i("Settings"),href:"/settings",description:i("Profile and security"),icon:f.Z,match:["/settings"]}],v=[{label:i("Home"),href:"/",description:i("Return to the homepage"),icon:p,match:["/"]},{label:i("Explore"),href:"/explore",description:i("Public collections"),icon:b,match:["/explore"]}];return(0,s.jsxs)("div",{className:"relative flex h-full flex-col gap-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(o.default,{href:"/",className:"flex items-center gap-3",onClick:t,children:[(0,s.jsx)(a.default,{src:"/logo.png",alt:"Antique Catalogue",width:44,height:44,className:"rounded-full"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-display text-lg tracking-tight text-stone-100",children:i("Antique Catalogue")}),(0,s.jsx)("p",{className:"text-xs uppercase tracking-[0.35em] text-stone-400",children:i("Studio Archive")})]})]}),n?(0,s.jsx)("button",{type:"button",className:"flex h-9 w-9 items-center justify-center rounded-full border border-stone-700 text-stone-200 transition hover:border-stone-500 hover:text-stone-100",onClick:n,"aria-label":i("Close menu"),children:(0,s.jsx)(g.Z,{className:"h-4 w-4"})}):null]}),(0,s.jsx)("nav",{className:"space-y-2",children:y.map(e=>{let n=e.match.some(e=>r===e||r.startsWith("".concat(e,"/")));return(0,s.jsxs)(o.default,{href:e.href,onClick:t,className:(0,Z.cn)("group flex items-start gap-3 rounded-2xl px-3 py-3 transition",n?"bg-amber-100/10 text-amber-50 ring-1 ring-amber-200/30":"text-stone-200 hover:bg-stone-900/60 hover:text-stone-100"),children:[(0,s.jsx)("span",{className:(0,Z.cn)("mt-0.5 flex h-8 w-8 items-center justify-center rounded-xl transition",n?"bg-amber-200/15 text-amber-200":"bg-stone-900 text-stone-400 group-hover:text-stone-200"),children:(0,s.jsx)(e.icon,{className:"h-4 w-4"})}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:e.label}),(0,s.jsx)("span",{className:(0,Z.cn)("mt-1 block text-xs",n?"text-amber-200/80":"text-stone-400"),children:e.description})]})]},e.href)})}),(0,s.jsx)("div",{className:"my-2 border-t border-stone-800/70"}),(0,s.jsx)("nav",{className:"space-y-2",children:v.map(e=>{let n=e.match.some(e=>r===e||r.startsWith("".concat(e,"/")));return(0,s.jsxs)(o.default,{href:e.href,onClick:t,className:(0,Z.cn)("group flex items-start gap-3 rounded-2xl px-3 py-3 transition",n?"bg-amber-100/10 text-amber-50 ring-1 ring-amber-200/30":"text-stone-200 hover:bg-stone-900/60 hover:text-stone-100"),children:[(0,s.jsx)("span",{className:(0,Z.cn)("mt-0.5 flex h-8 w-8 items-center justify-center rounded-xl transition",n?"bg-amber-200/15 text-amber-200":"bg-stone-900 text-stone-400 group-hover:text-stone-200"),children:(0,s.jsx)(e.icon,{className:"h-4 w-4"})}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:e.label}),(0,s.jsx)("span",{className:(0,Z.cn)("mt-1 block text-xs",n?"text-amber-200/80":"text-stone-400"),children:e.description})]})]},e.href)})})]})},S=e=>{var t;let{children:n}=e,[a,o]=r.useState(!1),i=(0,l.usePathname)(),c=(0,l.useRouter)(),u=(0,l.useSearchParams)(),{logout:d}=(0,j.a)(),{t:h}=(0,w.Q)(),[m,x]=r.useState(!1),[f,p]=r.useState(null!==(t=u.get("query"))&&void 0!==t?t:"");r.useEffect(()=>{var e;p(null!==(e=u.get("query"))&&void 0!==e?e:"")},[u]);let b=e=>{if("Enter"!==e.key)return;e.preventDefault();let t=e.currentTarget.value.trim();t&&c.push("/search?query=".concat(encodeURIComponent(t)))},g=async()=>{if(!m){x(!0),window.sessionStorage.setItem("antique_logout_redirect","home");try{await d()}finally{x(!1)}}};return r.useEffect(()=>{o(!1)},[i]),r.useEffect(()=>{if(!a){document.body.style.overflow="";return}return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[a]),r.useEffect(()=>{if(!a)return;let e=e=>{"Escape"===e.key&&o(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a]),(0,s.jsxs)("div",{className:"relative min-h-screen bg-stone-50 text-stone-950",children:[(0,s.jsxs)("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute -top-32 right-[-6rem] h-72 w-72 rounded-full bg-amber-200/30 blur-[140px]"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 h-64 w-64 rounded-full bg-stone-900/10 blur-[120px]"}),(0,s.jsx)("div",{className:"absolute top-1/3 right-1/4 h-40 w-40 rounded-full bg-amber-100/40 blur-[90px]"})]}),(0,s.jsxs)("div",{className:"relative flex min-h-screen",children:[(0,s.jsxs)("aside",{className:"relative hidden h-screen w-72 flex-col overflow-y-auto overscroll-contain border-r border-stone-900/80 bg-stone-950 text-stone-100 lg:sticky lg:top-0 lg:flex",children:[(0,s.jsx)("div",{className:"pointer-events-none absolute -top-24 left-10 h-32 w-32 rounded-full bg-amber-300/20 blur-[90px]"}),(0,s.jsx)("div",{className:"relative flex h-full flex-col p-6",children:(0,s.jsx)(C,{})})]}),(0,s.jsxs)("div",{className:"flex min-h-screen flex-1 flex-col",children:[(0,s.jsxs)("header",{className:"sticky top-0 z-30 border-b border-stone-200/80 bg-stone-50/80 backdrop-blur",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 lg:px-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{type:"button",className:"flex h-10 w-10 items-center justify-center rounded-full border border-stone-200 bg-white/80 text-stone-700 shadow-sm transition hover:border-stone-300 hover:text-stone-900 lg:hidden",onClick:()=>o(!0),"aria-label":h("Open menu"),children:(0,s.jsx)(y,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-[0.4em] text-amber-700",children:h("Workspace")}),(0,s.jsx)("p",{className:"font-display text-xl text-stone-900",children:h("Catalogue Studio")})]})]}),(0,s.jsxs)("div",{className:"hidden items-center gap-3 md:flex",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(v.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-stone-400"}),(0,s.jsx)("input",{type:"search",placeholder:h("Search all items"),className:"h-10 w-64 rounded-full border border-stone-200 bg-white/90 pl-9 pr-3 text-sm text-stone-700 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200",value:f,onChange:e=>p(e.target.value),onKeyDown:b})]}),(0,s.jsxs)(N.z,{size:"sm",variant:"secondary",onClick:g,disabled:m,children:[(0,s.jsx)(k.Z,{className:"h-4 w-4"}),h(m?"Logging out...":"Log out")]})]})]}),(0,s.jsx)("div",{className:"px-6 pb-4 md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(v.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-stone-400"}),(0,s.jsx)("input",{type:"search",placeholder:h("Search all items"),className:"h-10 w-full rounded-full border border-stone-200 bg-white/90 pl-9 pr-3 text-sm text-stone-700 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200",value:f,onChange:e=>p(e.target.value),onKeyDown:b})]}),(0,s.jsx)(N.z,{size:"sm",variant:"secondary",onClick:g,disabled:m,children:h(m?"Logging out...":"Log out")})]})})]}),(0,s.jsx)("main",{className:"flex-1 px-6 pb-12 pt-8 lg:px-10",children:n})]})]}),a?(0,s.jsxs)("div",{className:"fixed inset-0 z-40 lg:hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-stone-950/60",onClick:()=>o(!1)}),(0,s.jsx)("div",{className:"absolute left-0 top-0 h-full w-80 max-w-[85vw] overflow-y-auto overscroll-contain border-r border-stone-900 bg-stone-950 p-6 text-stone-100 shadow-2xl",children:(0,s.jsx)(C,{onNavigate:()=>o(!1),onClose:()=>o(!1)})})]}):null]})}},7908:function(e,t,n){"use strict";n.d(t,{AuthGuard:function(){return u}});var s=n(7437),r=n(2265),a=n(6463),o=n(2328),l=n(1295);let i=e=>{if(!e)return"/login";let t=encodeURIComponent(e);return"/login?next=".concat(t)},c="antique_logout_redirect",u=e=>{let{children:t}=e,{status:n}=(0,o.a)(),u=(0,a.useRouter)(),d=(0,a.usePathname)(),{t:h}=(0,l.Q)();return(r.useEffect(()=>{if("unauthenticated"===n){if("home"===window.sessionStorage.getItem(c)){window.sessionStorage.removeItem(c),u.replace("/");return}u.replace(i(d))}},[n,d,u]),"loading"===n)?(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-stone-50 text-sm text-stone-500",children:h("Loading your workspace...")}):"unauthenticated"===n?null:(0,s.jsx)(s.Fragment,{children:t})}},2328:function(e,t,n){"use strict";n.d(t,{H:function(){return l},a:function(){return i}});var s=n(7437),r=n(2265),a=n(6264);let o=r.createContext(void 0),l=e=>{let{children:t}=e,[n,l]=r.useState(null),[i,c]=r.useState("loading"),[u,d]=r.useState(null),h=r.useCallback(async()=>{c("loading"),d(null);try{let e=await a.iJ.me();l(e),c("authenticated")}catch(e){l(null),(0,a.k0)(e)&&(401===e.status||403===e.status)?c("unauthenticated"):(c("unauthenticated"),d((0,a.k0)(e)?e.detail:"Unable to reach server"))}},[]);r.useEffect(()=>{h()},[h]);let m=r.useCallback(async e=>{d(null),await a.iJ.login(e),await h()},[h]),x=r.useCallback(async()=>{d(null);try{await a.iJ.logout()}finally{l(null),c("unauthenticated")}},[]),f=r.useCallback(async()=>{await h()},[h]),p=r.useMemo(()=>({user:n,status:i,error:u,isAuthenticated:"authenticated"===i,login:m,logout:x,refresh:f}),[n,i,u,m,x,f]);return(0,s.jsx)(o.Provider,{value:p,children:t})},i=()=>{let e=r.useContext(o);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},495:function(e,t,n){"use strict";n.d(t,{z:function(){return c}});var s=n(7437),r=n(2265),a=n(2974),o=n(3027),l=n(7440);let i=(0,o.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:n,variant:r,size:o,asChild:c=!1,...u}=e,d=c?a.g7:"button";return(0,s.jsx)(d,{className:(0,l.cn)(i({variant:r,size:o,className:n})),ref:t,...u})});c.displayName="Button"},7440:function(e,t,n){"use strict";n.d(t,{cn:function(){return a}});var s=n(4839),r=n(6164);function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,s.W)(t))}},1066:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var s=n(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),o=(e,t)=>{let n=(0,s.forwardRef)((n,o)=>{let{color:l="currentColor",size:i=24,strokeWidth:c=2,absoluteStrokeWidth:u,className:d="",children:h,...m}=n;return(0,s.createElement)("svg",{ref:o,...r,width:i,height:i,stroke:l,strokeWidth:u?24*Number(c)/Number(i):c,className:["lucide","lucide-".concat(a(e)),d].join(" "),...m},[...t.map(e=>{let[t,n]=e;return(0,s.createElement)(t,n)}),...Array.isArray(h)?h:[h]])});return n.displayName="".concat(e),n}},8496:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n(1066).Z)("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]])},9896:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n(1066).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},4817:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n(1066).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},1326:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n(1066).Z)("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]])},3907:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n(1066).Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},9338:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n(1066).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},4697:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n(1066).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5430:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n(1066).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])},6463:function(e,t,n){"use strict";var s=n(1169);n.o(s,"useParams")&&n.d(t,{useParams:function(){return s.useParams}}),n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}}),n.o(s,"useSearchParams")&&n.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[165,138,648,846,971,23,744],function(){return e(e.s=9070)}),_N_E=e.O()}]);