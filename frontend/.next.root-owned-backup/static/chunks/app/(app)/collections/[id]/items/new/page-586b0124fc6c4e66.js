(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[143],{1653:function(e,s,t){Promise.resolve().then(t.bind(t,1795))},1795:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var a=t(7437),l=t(2265),i=t(7138),r=t(6463),n=t(5137),d=t(4378),o=t(2919),c=t(8041),x=t(1295),h=t(495),m=t(6264);function u(){var e,s,t,u,p,j;let f=(0,r.useParams)(),g=(0,r.useRouter)(),{t:v}=(0,x.Q)(),N=Array.isArray(null==f?void 0:f.id)?f.id[0]:null==f?void 0:f.id,[b,y]=l.useState({status:"loading"}),[w,k]=l.useState({status:"loading",data:[]}),[C,z]=l.useState(null),_=l.useCallback(async()=>{if(!N){y({status:"error",error:"Collection ID was not provided."});return}y({status:"loading"});try{let e=await m.Wo.get(N);y({status:"ready",data:e})}catch(e){y({status:"error",error:(0,m.k0)(e)?e.detail:"We couldn't load this collection."})}},[N]),W=l.useCallback(async()=>{if(!N){k({status:"error",data:[],error:"Collection ID was not provided."});return}k(e=>({...e,status:"loading",error:void 0}));try{let e=await m.cK.list(N);k({status:"ready",data:e})}catch(e){k({status:"error",data:[],error:(0,m.k0)(e)?e.detail:"We couldn't load the collection schema."})}},[N]);l.useEffect(()=>{_(),W()},[_,W]);let E=async e=>{if(N){z(null);try{let s=await m.zg.create(N,{name:e.name,notes:e.notes,metadata:e.metadata,is_highlight:e.is_highlight});g.push("/collections/".concat(N,"/items/").concat(s.id))}catch(e){z((0,m.k0)(e)?e.detail:"We couldn't create this item. Please try again.")}}};return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("header",{className:"flex flex-wrap items-start justify-between gap-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(h.z,{variant:"ghost",size:"sm",asChild:!0,children:(0,a.jsxs)(i.default,{href:"/collections/".concat(null!=N?N:""),children:[(0,a.jsx)(n.Z,{className:"h-4 w-4"}),v("Back to collection")]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.4em] text-amber-700",children:v("New item")}),(0,a.jsx)("h1",{className:"font-display mt-4 text-3xl text-stone-900",children:v("Capture a new item for your archive.")}),(0,a.jsx)("p",{className:"mt-3 max-w-2xl text-sm text-stone-600",children:v("Record the item name, optional notes, and the metadata fields you defined in your schema.")})]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-3",children:(0,a.jsxs)(h.z,{variant:"outline",onClick:W,children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),v("Reload schema")]})})]}),"loading"===b.status?(0,a.jsx)("div",{className:"rounded-3xl border border-dashed border-stone-200 bg-white/80 p-8 text-sm text-stone-500","aria-busy":"true",children:v("Loading collection details...")}):"error"===b.status?(0,a.jsxs)("div",{className:"rounded-3xl border border-rose-200 bg-rose-50/80 p-6",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-rose-700",children:v("We hit a snag loading this collection.")}),(0,a.jsx)("p",{className:"mt-2 text-sm text-rose-600",children:v(null!==(t=b.error)&&void 0!==t?t:"Please try again.")}),(0,a.jsxs)("div",{className:"mt-4 flex flex-wrap gap-3",children:[(0,a.jsx)(h.z,{variant:"outline",onClick:_,children:v("Try again")}),(0,a.jsx)(h.z,{variant:"ghost",asChild:!0,children:(0,a.jsx)(i.default,{href:"/collections",children:v("Back to collections")})})]})]}):(0,a.jsxs)("section",{className:"grid gap-6 lg:grid-cols-[2fr_1fr]",children:[(0,a.jsxs)("div",{className:"rounded-3xl border border-stone-200 bg-white/90 p-6 shadow-sm",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:v("Item details")}),(0,a.jsx)("h2",{className:"font-display mt-3 text-2xl text-stone-900",children:null===(e=b.data)||void 0===e?void 0:e.name}),(0,a.jsx)("p",{className:"mt-3 text-sm text-stone-600",children:null!==(u=null===(s=b.data)||void 0===s?void 0:s.description)&&void 0!==u?u:v("Add a description to capture the story behind this collection.")}),(0,a.jsx)("div",{className:"mt-6",children:"loading"===w.status?(0,a.jsx)("div",{className:"rounded-2xl border border-dashed border-stone-200 bg-white/70 p-6 text-sm text-stone-500",children:v("Loading schema fields...")}):"error"===w.status?(0,a.jsxs)("div",{className:"space-y-3 rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:[(0,a.jsx)("p",{children:v(null!==(p=w.error)&&void 0!==p?p:"We couldn't load the schema fields. Please try again.")}),(0,a.jsx)(h.z,{size:"sm",variant:"outline",onClick:W,children:v("Try again")})]}):(0,a.jsx)(c.W,{fields:w.data,onSubmit:E,submitLabel:v("Create item"),submitPendingLabel:v("Creating item..."),secondaryAction:(0,a.jsx)(h.z,{variant:"ghost",type:"button",asChild:!0,children:(0,a.jsx)(i.default,{href:"/collections/".concat(N),children:v("Cancel")})}),formError:C})})]}),(0,a.jsxs)("aside",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"rounded-3xl border border-stone-200 bg-white/80 p-6 shadow-sm",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:v("Schema snapshot")}),"loading"===w.status?(0,a.jsx)("p",{className:"mt-4 text-sm text-stone-500",children:v("Loading schema fields...")}):"error"===w.status?(0,a.jsx)("p",{className:"mt-4 text-sm text-rose-600",children:v(null!==(j=w.error)&&void 0!==j?j:"We couldn't load schema fields.")}):0===w.data.length?(0,a.jsxs)("div",{className:"mt-4 space-y-3 text-sm text-stone-600",children:[(0,a.jsx)("p",{children:v("No schema fields yet.")}),(0,a.jsx)(h.z,{size:"sm",variant:"secondary",asChild:!0,children:(0,a.jsx)(i.default,{href:"/collections/".concat(N,"/settings"),children:v("Define schema")})})]}):(0,a.jsxs)("div",{className:"mt-4 space-y-3 text-sm text-stone-600",children:[(0,a.jsx)("p",{children:v("{count} fields available.",{count:w.data.length})}),(0,a.jsxs)("div",{className:"space-y-2",children:[w.data.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsx)("span",{className:"font-medium text-stone-900",children:e.name}),(0,a.jsx)("span",{className:"text-xs uppercase tracking-[0.2em] text-stone-400",children:e.field_type})]},e.id)),w.data.length>5?(0,a.jsx)("p",{className:"text-xs text-stone-400",children:v("+{count} more fields",{count:w.data.length-5})}):null]}),(0,a.jsx)(h.z,{size:"sm",variant:"ghost",asChild:!0,children:(0,a.jsx)(i.default,{href:"/collections/".concat(N,"/settings"),children:v("Edit schema")})})]})]}),(0,a.jsxs)("div",{className:"rounded-3xl border border-stone-900/90 bg-gradient-to-br from-stone-950 via-stone-900 to-stone-800 p-6 text-stone-100 shadow-sm",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-400",children:v("Capture notes")}),(0,a.jsx)("h3",{className:"font-display mt-3 text-2xl text-stone-100",children:v("Keep provenance close at hand.")}),(0,a.jsx)("p",{className:"mt-3 text-sm text-stone-300",children:v("Use the notes field to document acquisition details, restoration work, or exhibition history alongside metadata.")}),(0,a.jsxs)("div",{className:"mt-6 flex items-center gap-3 text-xs text-stone-300",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 text-amber-300"}),v("Metadata fields are validated before saving.")]})]})]})]})]})}}},function(e){e.O(0,[165,138,439,846,553,971,23,744],function(){return e(e.s=1653)}),_N_E=e.O()}]);