(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{2164:function(e,t,s){Promise.resolve().then(s.bind(s,4569))},4569:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var a=s(7437),r=s(2265),n=s(6648),l=s(7138),i=s(1066);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,i.Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var d=s(8496),c=s(7524),u=s(9338),m=s(8281),x=s(4109);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,i.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),p=(0,i.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var f=s(233),v=s(883),g=s(2328),b=s(1295),y=s(495),j=s(6264);function N(){var e,t,s,i,N;let{t:w,locale:k}=(0,b.Q)(),{refresh:Z}=(0,g.a)(),[C,_]=r.useState({status:"loading",data:null}),[M,S]=r.useState(""),[z,A]=r.useState({status:"idle"}),[P,E]=r.useState({status:"idle"}),[L,U]=r.useState(0),V=r.useRef(null),W=r.useCallback(e=>{if(!e)return"-";let t=new Date(e);return Number.isNaN(t.getTime())?e:new Intl.DateTimeFormat(k,{month:"short",day:"numeric",year:"numeric"}).format(t)},[k]),H=r.useCallback(async()=>{_(e=>({...e,status:"loading",error:void 0}));try{let e=await j.c_.me();_({status:"ready",data:e}),S(e.username)}catch(e){_(t=>({status:"error",data:t.data,error:(0,j.k0)(e)?e.detail:"We couldn't load your profile."}))}},[]);r.useEffect(()=>{H()},[H]);let R=async e=>{e.preventDefault(),A({status:"saving"});try{let e=await j.c_.updateMe({username:M});_({status:"ready",data:e}),S(e.username),A({status:"saved",message:"Username updated."}),await Z()}catch(e){A({status:"error",message:(0,j.k0)(e)?e.detail:"We couldn't update your username."})}},q=async e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){E({status:"uploading"});try{let e=await j.c_.uploadAvatar(s);_({status:"ready",data:e}),U(e=>e+1),E({status:"idle"})}catch(e){E({status:"error",message:(0,j.k0)(e)?e.detail:"We couldn't upload your avatar."})}V.current&&(V.current.value="")}},J=async()=>{E({status:"deleting"});try{await j.c_.deleteAvatar(),_(e=>e.data?{...e,data:{...e.data,has_avatar:!1}}:e),E({status:"idle"})}catch(e){E({status:"error",message:(0,j.k0)(e)?e.detail:"We couldn't remove your avatar."})}},B=C.data;return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("header",{className:"rounded-3xl border border-stone-200 bg-white/90 p-6 shadow-sm",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.4em] text-amber-700",children:w("Profile")}),(0,a.jsx)("h1",{className:"font-display mt-4 text-3xl text-stone-900",children:w("Your public profile")}),(0,a.jsx)("p",{className:"mt-3 max-w-2xl text-sm text-stone-600",children:w("Manage how your public archive identity appears to everyone.")}),(null==B?void 0:B.username)?(0,a.jsx)("div",{className:"mt-5",children:(0,a.jsx)(y.z,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)(l.default,{href:"/profile/".concat(encodeURIComponent(B.username)),children:[(0,a.jsx)(o,{className:"h-4 w-4"}),w("View public profile")]})})}):null]}),(0,a.jsxs)("section",{className:"rounded-3xl border border-stone-900 bg-stone-950 p-6 text-stone-100",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-400",children:w("Profile summary")}),(0,a.jsx)("p",{className:"mt-3 text-sm text-stone-300",children:w("Member since {date}",{date:W(null==B?void 0:B.created_at)})}),(0,a.jsxs)("div",{className:"mt-4 grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)("div",{className:"rounded-xl border border-stone-800 bg-stone-900/70 p-3",children:[(0,a.jsxs)("p",{className:"inline-flex items-center gap-2 text-xs text-stone-300",children:[(0,a.jsx)(d.Z,{className:"h-3.5 w-3.5 text-amber-300"}),w("Public collections")]}),(0,a.jsx)("p",{className:"mt-2 text-xl font-semibold text-stone-100",children:null!==(e=null==B?void 0:B.public_collection_count)&&void 0!==e?e:0})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-stone-800 bg-stone-900/70 p-3",children:[(0,a.jsxs)("p",{className:"inline-flex items-center gap-2 text-xs text-stone-300",children:[(0,a.jsx)(c.Z,{className:"h-3.5 w-3.5 text-amber-300"}),w("Public items")]}),(0,a.jsx)("p",{className:"mt-2 text-xl font-semibold text-stone-100",children:null!==(t=null==B?void 0:B.public_item_count)&&void 0!==t?t:0})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-stone-800 bg-stone-900/70 p-3",children:[(0,a.jsxs)("p",{className:"inline-flex items-center gap-2 text-xs text-stone-300",children:[(0,a.jsx)(u.Z,{className:"h-3.5 w-3.5 text-amber-300"}),w("Stars earned")]}),(0,a.jsx)("p",{className:"mt-2 text-xl font-semibold text-stone-100",children:null!==(s=null==B?void 0:B.earned_star_count)&&void 0!==s?s:0})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-stone-800 bg-stone-900/70 p-3",children:[(0,a.jsxs)("p",{className:"inline-flex items-center gap-2 text-xs text-stone-300",children:[(0,a.jsx)(m.Z,{className:"h-3.5 w-3.5 text-amber-300"}),w("Star rank")]}),(0,a.jsxs)("p",{className:"mt-2 text-xl font-semibold text-stone-100",children:["#",null!==(i=null==B?void 0:B.star_rank)&&void 0!==i?i:1]})]})]})]}),(0,a.jsxs)("section",{className:"grid gap-6 lg:grid-cols-[1.4fr_1fr]",children:[(0,a.jsxs)("div",{className:"rounded-3xl border border-stone-200 bg-white/90 p-6 shadow-sm",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:w("Username")}),(0,a.jsx)("h2",{className:"font-display mt-3 text-2xl text-stone-900",children:w("Choose your public username")}),(0,a.jsx)("p",{className:"mt-2 text-sm text-stone-600",children:w("Use up to 12 characters with letters, numbers, underscores, or hyphens.")}),"loading"!==C.status||B?"error"!==C.status||B?(0,a.jsxs)("form",{className:"mt-6 space-y-4",onSubmit:R,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-stone-700",htmlFor:"username",children:w("Public username")}),(0,a.jsx)("input",{id:"username",type:"text",maxLength:12,autoComplete:"off",className:"mt-2 w-full rounded-xl border border-stone-200 bg-white px-4 py-3 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200",value:M,onChange:e=>S(e.target.value)})]}),"error"===z.status&&z.message?(0,a.jsx)("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:w(z.message)}):null,"saved"===z.status&&z.message?(0,a.jsx)("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700",children:w(z.message)}):null,(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsxs)(y.z,{type:"submit",disabled:"saving"===z.status,children:["saving"===z.status?(0,a.jsx)(x.Z,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(h,{className:"h-4 w-4"}),w("saving"===z.status?"Saving...":"Save username")]}),(0,a.jsx)(y.z,{variant:"outline",type:"button",onClick:()=>H(),children:w("Refresh")})]})]}):(0,a.jsx)("p",{className:"mt-6 text-sm text-rose-600",children:w(null!==(N=C.error)&&void 0!==N?N:"We couldn't load your profile.")}):(0,a.jsx)("p",{className:"mt-6 text-sm text-stone-500",children:w("Loading profile...")})]}),(0,a.jsxs)("div",{className:"rounded-3xl border border-stone-200 bg-white/90 p-6 shadow-sm",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:w("Profile picture")}),(0,a.jsx)("h2",{className:"font-display mt-3 text-2xl text-stone-900",children:w("Set your avatar")}),(0,a.jsx)("p",{className:"mt-2 text-sm text-stone-600",children:w("Upload a photo that represents you. Max 5MB, JPEG or PNG.")}),(0,a.jsxs)("div",{className:"mt-6 flex flex-wrap items-center gap-6",children:[(0,a.jsx)("div",{className:"relative h-24 w-24 shrink-0 overflow-hidden rounded-full border-2 border-stone-200 bg-stone-100",children:(null==B?void 0:B.has_avatar)?(0,a.jsx)(n.default,{src:(0,j.Qx)(B.id,"medium"),alt:B.username,width:96,height:96,className:"h-full w-full object-cover",unoptimized:!0},L):(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,a.jsx)(p,{className:"h-10 w-10 text-stone-300"})})}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)("input",{ref:V,type:"file",accept:"image/jpeg,image/png,image/webp",className:"hidden",onChange:q}),(0,a.jsxs)(y.z,{variant:"outline",onClick:()=>{var e;return null===(e=V.current)||void 0===e?void 0:e.click()},disabled:"uploading"===P.status||"deleting"===P.status,children:["uploading"===P.status?(0,a.jsx)(x.Z,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(f.Z,{className:"h-4 w-4"}),w("uploading"===P.status?"Uploading...":"Upload photo")]}),(null==B?void 0:B.has_avatar)?(0,a.jsxs)(y.z,{variant:"outline",onClick:J,disabled:"uploading"===P.status||"deleting"===P.status,className:"text-rose-600 hover:text-rose-700",children:["deleting"===P.status?(0,a.jsx)(x.Z,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(v.Z,{className:"h-4 w-4"}),w("deleting"===P.status?"Removing...":"Remove")]}):null]})]}),"error"===P.status&&P.message?(0,a.jsx)("div",{className:"mt-4 rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:w(P.message)}):null]})]})]})}},2328:function(e,t,s){"use strict";s.d(t,{H:function(){return i},a:function(){return o}});var a=s(7437),r=s(2265),n=s(6264);let l=r.createContext(void 0),i=e=>{let{children:t}=e,[s,i]=r.useState(null),[o,d]=r.useState("loading"),[c,u]=r.useState(null),m=r.useCallback(async()=>{d("loading"),u(null);try{let e=await n.iJ.me();i(e),d("authenticated")}catch(e){i(null),(0,n.k0)(e)&&(401===e.status||403===e.status)?d("unauthenticated"):(d("unauthenticated"),u((0,n.k0)(e)?e.detail:"Unable to reach server"))}},[]);r.useEffect(()=>{m()},[m]);let x=r.useCallback(async e=>{u(null),await n.iJ.login(e),await m()},[m]),h=r.useCallback(async()=>{u(null);try{await n.iJ.logout()}finally{i(null),d("unauthenticated")}},[]),p=r.useCallback(async()=>{await m()},[m]),f=r.useMemo(()=>({user:s,status:o,error:c,isAuthenticated:"authenticated"===o,login:x,logout:h,refresh:p}),[s,o,c,x,h,p]);return(0,a.jsx)(l.Provider,{value:f,children:t})},o=()=>{let e=r.useContext(l);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},495:function(e,t,s){"use strict";s.d(t,{z:function(){return d}});var a=s(7437),r=s(2265),n=s(2974),l=s(3027),i=s(7440);let o=(0,l.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(o({variant:r,size:l,className:s})),ref:t,...c})});d.displayName="Button"},7440:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(4839),r=s(6164);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},1066:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),l=(e,t)=>{let s=(0,a.forwardRef)((s,l)=>{let{color:i="currentColor",size:o=24,strokeWidth:d=2,absoluteStrokeWidth:c,className:u="",children:m,...x}=s;return(0,a.createElement)("svg",{ref:l,...r,width:o,height:o,stroke:i,strokeWidth:c?24*Number(d)/Number(o):d,className:["lucide","lucide-".concat(n(e)),u].join(" "),...x},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])});return s.displayName="".concat(e),s}},8281:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(1066).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},233:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(1066).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},8496:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(1066).Z)("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]])},4109:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(1066).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7524:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(1066).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},9338:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(1066).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},883:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(1066).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},function(e){e.O(0,[165,138,648,846,971,23,744],function(){return e(e.s=2164)}),_N_E=e.O()}]);