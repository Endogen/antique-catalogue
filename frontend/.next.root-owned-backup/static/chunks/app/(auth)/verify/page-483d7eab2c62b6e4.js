(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{1949:function(e,t,s){Promise.resolve().then(s.bind(s,9597))},9597:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var n=s(7437),r=s(2265),a=s(6648),i=s(7138),l=s(6463),o=s(1014),c=s(9343),d=s(537),u=s(2328),m=s(1295),x=s(495),f=s(6264);let h=e=>d.Ry({token:d.Z_().trim().min(1,e("Verification token is required"))}),p=[{title:"Locate",detail:"Check your inbox for the verification token."},{title:"Verify",detail:"Paste the token here to activate your account."},{title:"Sign in",detail:"Return to login once verification is complete."}],g=e=>{var t,s;return null!==(s=null!==(t=e.get("token"))&&void 0!==t?t:e.get("t"))&&void 0!==s?s:""};function b(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),{status:s}=(0,u.a)(),{t:d}=(0,m.Q)(),[b,v]=r.useState(null),[y,j]=r.useState(null),N=r.useMemo(()=>h(d),[d]),{register:k,handleSubmit:w,setValue:C,formState:{errors:S,isSubmitting:E}}=(0,c.cI)({resolver:(0,o.F)(N),defaultValues:{token:g(t)}});r.useEffect(()=>{"authenticated"===s&&e.replace("/dashboard")},[s,e]),r.useEffect(()=>{let e=g(t);e&&C("token",e)},[t,C]);let V=async e=>{v(null),j(null);try{let t=await f.iJ.verifyEmail({token:e.token.trim()});j(t.message||"Email verified successfully.")}catch(e){v((0,f.k0)(e)?e.detail:"We couldn't verify that token. Please try again.")}};if("authenticated"===s)return(0,n.jsx)("div",{className:"col-span-full flex min-h-[60vh] items-center justify-center text-sm text-stone-500",children:d("Redirecting to your workspace...")});let A=!!y;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("header",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,n.jsxs)(i.default,{href:"/",className:"flex items-center gap-3",children:[(0,n.jsx)(a.default,{src:"/logo.png",alt:"Antique Catalogue",width:44,height:44,className:"rounded-full"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-display text-lg tracking-tight",children:d("Antique Catalogue")}),(0,n.jsx)("p",{className:"text-xs uppercase tracking-[0.35em] text-stone-500",children:d("Studio Archive")})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3 text-sm text-stone-600",children:[(0,n.jsx)("span",{className:"hidden sm:inline",children:d("Already verified?")}),(0,n.jsx)(x.z,{variant:"outline",size:"sm",asChild:!0,children:(0,n.jsx)(i.default,{href:"/login",children:d("Sign in")})})]})]}),(0,n.jsxs)("section",{className:"mt-10 rounded-3xl border border-stone-200 bg-white/90 p-8 shadow-sm",children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-[0.4em] text-amber-700",children:d("Verify your email")}),(0,n.jsx)("h1",{className:"font-display mt-4 text-3xl text-stone-900",children:d("Activate your archive.")}),(0,n.jsx)("p",{className:"mt-3 text-sm text-stone-600",children:d("Enter the verification token we sent to your inbox to complete setup.")}),b?(0,n.jsx)("div",{role:"alert",className:"mt-6 rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:d(b)}):null,y?(0,n.jsxs)("div",{role:"status",className:"mt-6 rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700",children:[(0,n.jsx)("p",{className:"font-medium",children:d(y)}),(0,n.jsx)("p",{className:"mt-2 text-xs text-emerald-700",children:d("You can now sign in and start building your collection archive.")})]}):null,(0,n.jsxs)("form",{className:"mt-6 space-y-5",onSubmit:w(V),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium text-stone-700",htmlFor:"token",children:d("Verification token")}),(0,n.jsx)("input",{id:"token",type:"text",autoComplete:"one-time-code",disabled:A,className:"mt-2 w-full rounded-xl border border-stone-200 bg-white px-4 py-3 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200 disabled:cursor-not-allowed disabled:bg-stone-100","aria-invalid":S.token?"true":"false",placeholder:d("Paste your token"),...k("token")}),S.token?(0,n.jsx)("p",{className:"mt-2 text-xs text-rose-600",children:S.token.message}):null]}),(0,n.jsx)(x.z,{type:"submit",size:"lg",className:"w-full",disabled:E||A,children:A?d("Email verified"):E?d("Verifying..."):d("Verify email")})]}),(0,n.jsxs)("div",{className:"mt-6 flex flex-wrap items-center justify-between gap-3 text-xs text-stone-500",children:[(0,n.jsx)("span",{children:d("Need a fresh token?")}),(0,n.jsx)(i.default,{href:"/register",className:"font-medium text-amber-700 hover:text-amber-800",children:d("Create a new account")})]})]})]}),(0,n.jsxs)("aside",{className:"order-first lg:order-none",children:[(0,n.jsxs)("div",{className:"rounded-3xl border border-stone-900/90 bg-gradient-to-br from-stone-950 via-stone-900 to-stone-800 p-8 text-stone-100 shadow-sm",children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-[0.4em] text-stone-400",children:d("Next steps")}),(0,n.jsx)("h2",{className:"font-display mt-4 text-3xl",children:d("Confirm your studio access.")}),(0,n.jsx)("p",{className:"mt-3 text-sm text-stone-300",children:d("Verification keeps your catalogue secure and ensures notifications land in the right place.")}),(0,n.jsx)("ul",{className:"mt-6 space-y-4 text-sm",children:p.map((e,t)=>(0,n.jsxs)("li",{className:"flex items-start gap-4",children:[(0,n.jsxs)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-amber-200 text-sm font-semibold text-stone-900",children:["0",t+1]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium text-stone-100",children:d(e.title)}),(0,n.jsx)("p",{className:"mt-1 text-xs text-stone-300",children:d(e.detail)})]})]},e.title))})]}),(0,n.jsxs)("div",{className:"mt-6 rounded-3xl border border-stone-200 bg-white/85 p-6 shadow-sm",children:[(0,n.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:d("Helpful tip")}),(0,n.jsx)("p",{className:"mt-3 text-sm text-stone-700",children:d("Verification tokens are time-sensitive. If yours has expired, request a new one by registering again.")})]})]})]})}function v(){let{t:e}=(0,m.Q)();return(0,n.jsx)(r.Suspense,{fallback:(0,n.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center text-sm text-stone-500",children:e("Loading...")}),children:(0,n.jsx)(b,{})})}},2328:function(e,t,s){"use strict";s.d(t,{H:function(){return l},a:function(){return o}});var n=s(7437),r=s(2265),a=s(6264);let i=r.createContext(void 0),l=e=>{let{children:t}=e,[s,l]=r.useState(null),[o,c]=r.useState("loading"),[d,u]=r.useState(null),m=r.useCallback(async()=>{c("loading"),u(null);try{let e=await a.iJ.me();l(e),c("authenticated")}catch(e){l(null),(0,a.k0)(e)&&(401===e.status||403===e.status)?c("unauthenticated"):(c("unauthenticated"),u((0,a.k0)(e)?e.detail:"Unable to reach server"))}},[]);r.useEffect(()=>{m()},[m]);let x=r.useCallback(async e=>{u(null),await a.iJ.login(e),await m()},[m]),f=r.useCallback(async()=>{u(null);try{await a.iJ.logout()}finally{l(null),c("unauthenticated")}},[]),h=r.useCallback(async()=>{await m()},[m]),p=r.useMemo(()=>({user:s,status:o,error:d,isAuthenticated:"authenticated"===o,login:x,logout:f,refresh:h}),[s,o,d,x,f,h]);return(0,n.jsx)(i.Provider,{value:p,children:t})},o=()=>{let e=r.useContext(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},495:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var n=s(7437),r=s(2265),a=s(2974),i=s(3027),l=s(7440);let o=(0,i.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:c=!1,...d}=e,u=c?a.g7:"button";return(0,n.jsx)(u,{className:(0,l.cn)(o({variant:r,size:i,className:s})),ref:t,...d})});c.displayName="Button"},7440:function(e,t,s){"use strict";s.d(t,{cn:function(){return a}});var n=s(4839),r=s(6164);function a(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,n.W)(t))}}},function(e){e.O(0,[165,138,648,439,846,971,23,744],function(){return e(e.s=1949)}),_N_E=e.O()}]);