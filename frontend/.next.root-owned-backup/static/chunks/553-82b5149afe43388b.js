"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[553],{8041:function(e,t,r){r.d(t,{W:function(){return v}});var s=r(7437),i=r(2265),n=r(1014),a=r(9343),l=r(537),o=r(495),d=r(1295);let u=e=>l.Ry({name:l.Z_().min(1,e("Item name is required")).max(160,e("Keep the name under 160 characters")),notes:l.Z_().max(2e3,e("Keep the notes under 2000 characters")).optional().or(l.i0("")),metadata:l.IM(l._4()).optional(),is_highlight:l.O7().optional()}),m=e=>({text:e("Text"),number:e("Number"),date:e("Date"),timestamp:e("Timestamp"),checkbox:e("Checkbox"),select:e("Select")}),c=e=>[...e].sort((e,t)=>e.position-t.position||e.id-t.id),f=e=>{let t=new Map;return e.forEach(e=>{let r=e.trim();if(!r)return;let s=r.toLowerCase();t.has(s)||t.set(s,r)}),Array.from(t.values())},h=e=>(null==e?void 0:e.options)&&Array.isArray(e.options)?f(e.options.filter(e=>"string"==typeof e)):[],p=e=>null==e||"string"==typeof e&&""===e.trim(),x=e=>{let t=e.trim();if(!t)return"";let r=t.match(/^(\d{4}-\d{2}-\d{2})/);return r?r[1]:t},g=e=>{let t=e.trim();if(!t)return"";let r=t.replace(" ","T"),s=r.match(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2})/);return s?s[1]:r},b=(e,t)=>{let r={};return e.forEach(e=>{let s=String(e.id),i=t?t[e.name]:void 0;if(null==i){r[s]="checkbox"!==e.field_type&&"";return}if("number"===e.field_type){if("number"==typeof i&&!Number.isNaN(i)){r[s]=i;return}if("string"==typeof i){let e=Number(i);r[s]=Number.isNaN(e)?"":e;return}r[s]="";return}if("checkbox"===e.field_type){if("boolean"==typeof i){r[s]=i;return}if("string"==typeof i){r[s]="true"===i.toLowerCase();return}r[s]=!1;return}if("date"===e.field_type&&"string"==typeof i){r[s]=x(i);return}if("timestamp"===e.field_type&&"string"==typeof i){r[s]=g(i);return}if("string"==typeof i){r[s]=i;return}r[s]=String(i)}),r},y=(e,t,r)=>{let s=[],i={},n=null!=t?t:{};return(e.forEach(e=>{let t=String(e.id),a=n[t];if(p(a)){e.is_required&&s.push({fieldId:t,message:r("Field is required")});return}if("text"===e.field_type){if("string"!=typeof a){s.push({fieldId:t,message:r("Value must be a string")});return}let n=a.trim();if(e.is_required&&!n){s.push({fieldId:t,message:r("Field is required")});return}n&&(i[e.name]=n);return}if("number"===e.field_type){let n="number"==typeof a?a:"string"==typeof a?Number(a):NaN;if(Number.isNaN(n)){s.push({fieldId:t,message:r("Value must be a number")});return}i[e.name]=n;return}if("date"===e.field_type){if("string"!=typeof a){s.push({fieldId:t,message:r("Value must be a date (YYYY-MM-DD)")});return}let n=a.trim();if(!/^\d{4}-\d{2}-\d{2}$/.test(n)||Number.isNaN(new Date("".concat(n,"T00:00:00Z")).getTime())){s.push({fieldId:t,message:r("Value must be a date (YYYY-MM-DD)")});return}i[e.name]=n;return}if("timestamp"===e.field_type){if("string"!=typeof a){s.push({fieldId:t,message:r("Value must be a timestamp (ISO 8601)")});return}let n=a.trim();if(!n||!n.includes("T")&&!n.includes(" ")||Number.isNaN(new Date(n.endsWith("Z")?"".concat(n.slice(0,-1),"+00:00"):n).getTime())){s.push({fieldId:t,message:r("Value must be a timestamp (ISO 8601)")});return}i[e.name]=n;return}if("checkbox"===e.field_type){if("boolean"!=typeof a){s.push({fieldId:t,message:r("Value must be true or false")});return}i[e.name]=a;return}if("select"===e.field_type){if("string"!=typeof a){s.push({fieldId:t,message:r("Value must be a string")});return}let n=a.trim(),l=h(e.options);if(!l.length){s.push({fieldId:t,message:r("Select field is missing options")});return}if(!n||!l.includes(n)){s.push({fieldId:t,message:r("Value must be one of: {options}",{options:l.join(", ")})});return}i[e.name]=n;return}s.push({fieldId:t,message:r("Unsupported field type")})}),Object.keys(i).length)?{payload:i,errors:s}:{payload:null,errors:s}};function v(e){let{fields:t,initialValues:r,onSubmit:l,submitLabel:f,submitPendingLabel:p,secondaryAction:x,formError:g,render:v}=e,{t:N}=(0,d.Q)(),j=i.useMemo(()=>m(N),[N]),w=i.useMemo(()=>u(N),[N]),_=i.useMemo(()=>c(t),[t]),k=i.useMemo(()=>{var e,t,s;return{name:null!==(e=null==r?void 0:r.name)&&void 0!==e?e:"",notes:null!==(t=null==r?void 0:r.notes)&&void 0!==t?t:"",metadata:b(_,null==r?void 0:r.metadata),is_highlight:null!==(s=null==r?void 0:r.is_highlight)&&void 0!==s&&s}},[null==r?void 0:r.is_highlight,null==r?void 0:r.metadata,null==r?void 0:r.name,null==r?void 0:r.notes,_]),{register:M,handleSubmit:I,formState:{errors:C,isSubmitting:Y},reset:S,setError:V,clearErrors:D}=(0,a.cI)({resolver:(0,n.F)(w),defaultValues:k});i.useEffect(()=>{S(k)},[k,S]);let Z=i.useCallback((e,t)=>{let r=M("metadata.".concat(e),t);return{...r,onChange:t=>{r.onChange(t),D("metadata.".concat(e))}}},[D,M]),q=async e=>{var t;D("metadata");let r=e.name.trim(),s=(null===(t=e.notes)||void 0===t?void 0:t.trim())?e.notes.trim():null,{payload:i,errors:n}=y(_,e.metadata,N);if(n.length){n.forEach(e=>{V("metadata.".concat(e.fieldId),{type:"manual",message:e.message})});return}await l({name:r,notes:s,metadata:i,is_highlight:!!e.is_highlight})},E=C.metadata,A=g?(0,s.jsx)("div",{role:"alert",className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:N(g)}):null,F=(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-stone-700",htmlFor:"name",children:N("Item name")}),(0,s.jsx)("input",{id:"name",type:"text",autoComplete:"off",className:"mt-2 w-full rounded-xl border border-stone-200 bg-white px-4 py-3 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200","aria-invalid":C.name?"true":"false",...M("name")}),C.name?(0,s.jsx)("p",{className:"mt-2 text-xs text-rose-600",children:C.name.message}):null]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-stone-700",htmlFor:"notes",children:N("Notes")}),(0,s.jsx)("textarea",{id:"notes",rows:4,className:"mt-2 w-full rounded-xl border border-stone-200 bg-white px-4 py-3 text-sm text-stone-900 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200",...M("notes")}),C.notes?(0,s.jsx)("p",{className:"mt-2 text-xs text-rose-600",children:C.notes.message}):(0,s.jsx)("p",{className:"mt-2 text-xs text-stone-500",children:N("Optional context, provenance, or acquisition details.")})]}),(0,s.jsx)("div",{className:"rounded-2xl border border-amber-200/70 bg-amber-50/40 p-4",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-stone-800",htmlFor:"is_highlight",children:N("Spotlight item")}),(0,s.jsx)("p",{className:"mt-1 text-xs text-stone-600",children:N("Adds a warm glow to featured items across the catalogue.")})]}),(0,s.jsx)("input",{id:"is_highlight",type:"checkbox",className:"mt-1 h-5 w-5 rounded border-amber-300 text-amber-600 focus:ring-amber-200",...M("is_highlight")})]})})]}),L=(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-stone-500",children:N("Metadata")}),(0,s.jsx)("h3",{className:"font-display mt-3 text-2xl text-stone-900",children:N("Capture collection-specific fields.")}),(0,s.jsx)("p",{className:"mt-2 text-sm text-stone-600",children:N("Complete the schema-driven attributes for this item.")})]}),0===_.length?(0,s.jsx)("div",{className:"rounded-2xl border border-dashed border-stone-200 bg-white/70 p-6 text-sm text-stone-500",children:N("No schema fields yet. Define fields in collection settings to capture metadata.")}):(0,s.jsx)("div",{className:"grid gap-4",children:_.map(e=>{var t,r,i;let n=String(e.id),a=null==E?void 0:null===(t=E[n])||void 0===t?void 0:t.message,l="select"===e.field_type?h(e.options):[];return"checkbox"===e.field_type?(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4 rounded-2xl border border-stone-200 bg-white/80 p-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-stone-700",htmlFor:"metadata-".concat(e.id),children:e.name}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-stone-500",children:[null!==(r=j[e.field_type])&&void 0!==r?r:e.field_type,e.is_required?" \xb7 ".concat(N("Required")):" \xb7 ".concat(N("Optional"))]}),a?(0,s.jsx)("p",{className:"mt-2 text-xs text-rose-600",children:a}):null]}),(0,s.jsx)("input",{id:"metadata-".concat(e.id),type:"checkbox",className:"mt-1 h-5 w-5 rounded border-stone-300 text-amber-600 focus:ring-amber-200","aria-invalid":a?"true":"false",...Z(n)})]},e.id):(0,s.jsxs)("div",{className:"flex flex-col gap-2 rounded-2xl border border-stone-200 bg-white/80 p-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-stone-700",htmlFor:"metadata-".concat(e.id),children:e.name}),(0,s.jsxs)("span",{className:"text-xs uppercase tracking-[0.2em] text-stone-400",children:[null!==(i=j[e.field_type])&&void 0!==i?i:e.field_type,e.is_required?" \xb7 ".concat(N("Required")):" \xb7 ".concat(N("Optional"))]})]}),"select"===e.field_type?(0,s.jsxs)("select",{id:"metadata-".concat(e.id),className:"h-10 rounded-xl border border-stone-200 bg-white px-3 text-sm text-stone-700 shadow-sm focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200","aria-invalid":a?"true":"false",...Z(n),disabled:!l.length,children:[(0,s.jsx)("option",{value:"",children:N("Select a value")}),l.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}):(0,s.jsx)("input",{id:"metadata-".concat(e.id),type:"number"===e.field_type?"number":"date"===e.field_type?"date":"timestamp"===e.field_type?"datetime-local":"text",step:"number"===e.field_type?"any":void 0,className:"h-10 rounded-xl border border-stone-200 bg-white px-3 text-sm text-stone-700 shadow-sm transition focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-200","aria-invalid":a?"true":"false",placeholder:"date"===e.field_type?N("YYYY-MM-DD"):"timestamp"===e.field_type?N("YYYY-MM-DDThh:mm"):N("Enter value"),...Z(n,{setValueAs:"number"===e.field_type?e=>""===e||null===e?void 0:Number(e):void 0})}),a?(0,s.jsx)("p",{className:"text-xs text-rose-600",children:a}):null]},e.id)})})]}),T=(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[x,(0,s.jsx)(o.z,{type:"submit",disabled:Y,children:Y?null!=p?p:N("Saving..."):f})]});return(0,s.jsx)("form",{className:"space-y-8",onSubmit:I(q),children:v?v({formError:A,baseFields:F,metadataFields:L,actions:T}):(0,s.jsxs)(s.Fragment,{children:[A,F,L,T]})})}},495:function(e,t,r){r.d(t,{z:function(){return d}});var s=r(7437),i=r(2265),n=r(2974),a=r(3027),l=r(7440);let o=(0,a.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef((e,t)=>{let{className:r,variant:i,size:a,asChild:d=!1,...u}=e,m=d?n.g7:"button";return(0,s.jsx)(m,{className:(0,l.cn)(o({variant:i,size:a,className:r})),ref:t,...u})});d.displayName="Button"},7440:function(e,t,r){r.d(t,{cn:function(){return n}});var s=r(4839),i=r(6164);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.m6)((0,s.W)(t))}},1066:function(e,t,r){r.d(t,{Z:function(){return a}});var s=r(2265),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),a=(e,t)=>{let r=(0,s.forwardRef)((r,a)=>{let{color:l="currentColor",size:o=24,strokeWidth:d=2,absoluteStrokeWidth:u,className:m="",children:c,...f}=r;return(0,s.createElement)("svg",{ref:a,...i,width:o,height:o,stroke:l,strokeWidth:u?24*Number(d)/Number(o):d,className:["lucide","lucide-".concat(n(e)),m].join(" "),...f},[...t.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(c)?c:[c]])});return r.displayName="".concat(e),r}},5137:function(e,t,r){r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},2919:function(e,t,r){r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]])},4378:function(e,t,r){r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]])}}]);